---
import "../styles/global.css";
import { getSettings, urlFor } from "../lib/sanity";

interface Props {
    title: string;
}

const { title } = Astro.props;

// Fetch Site Settings
const settings = await getSettings().catch(() => null);

// Default Settings
const defaultSettings = {
    siteName: "ER of White Rock",
    contactPhone: "555-0123-4567",
    address: "10705 Northwest Hwy, Dallas, TX 75238",
    email: "info@erwhiterock.com",
    logo: null,
    footerLogo: null,
};

const siteSettings = settings || defaultSettings;
const { siteName, contactPhone, address, email, logo, footerLogo } =
    siteSettings;

// Format address for display
const addressParts = address?.split(",") || [
    "10705 Northwest Hwy",
    "Dallas, TX 75238",
];
---

<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta
            name="description"
            content={`${siteName} - 24/7 Emergency Care`}
        />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
        <meta name="generator" content={Astro.generator} />
        <title>{title}</title>
        <!-- Google Fonts - Public Sans -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@300;400;500;600;700;800;900&display=swap"
            rel="stylesheet"
        />
        <!-- Material Symbols -->
        <link
            href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
            rel="stylesheet"
        />
    </head>
    <body
        class="bg-background-light text-text-main font-display antialiased overflow-x-hidden selection:bg-primary selection:text-white"
    >
        <!-- Header -->
        <header
            class="fixed top-0 w-full z-50 bg-white/95 backdrop-blur-md shadow-sm border-b border-gray-100 transition-all duration-300"
        >
            <div class="max-w-[1280px] mx-auto px-6 lg:px-12">
                <div class="flex items-center justify-between h-20 md:h-24">
                    <!-- Logo -->
                    <a class="flex items-center gap-4 group" href="/">
                        {
                            logo ? (
                                <img
                                    src={urlFor(logo).width(200).url()}
                                    alt={`${siteName} Logo`}
                                    class="w-16 h-16 object-contain group-hover:scale-105 transition-transform duration-300"
                                />
                            ) : (
                                <img
                                    src="/logo.png"
                                    alt={`${siteName} Logo`}
                                    class="w-16 h-16 object-contain group-hover:scale-105 transition-transform duration-300"
                                />
                            )
                        }
                        <div class="flex flex-col">
                            <h1
                                class="text-2xl font-black tracking-tight text-primary leading-none"
                            >
                                {siteName}
                            </h1>
                            <p
                                class="text-[10px] font-bold tracking-[0.2em] uppercase text-text-muted mt-1"
                            >
                                Emergency Care
                            </p>
                        </div>
                    </a>

                    <!-- Navigation -->
                    <nav class="hidden lg:flex items-center gap-6 xl:gap-8">
                        <a
                            class="text-[15px] font-semibold text-text-main hover:text-primary transition-colors whitespace-nowrap"
                            href="#services">ER Services</a
                        >
                        <a
                            class="text-[15px] font-semibold text-text-main hover:text-primary transition-colors whitespace-nowrap"
                            href="#physicians">Our Physicians</a
                        >
                        <a
                            class="text-[15px] font-semibold text-text-main hover:text-primary transition-colors whitespace-nowrap"
                            href="#insurance">Ins. & Billing Info</a
                        >
                        <a
                            class="text-[15px] font-semibold text-text-main hover:text-primary transition-colors whitespace-nowrap"
                            href="#about">About Us</a
                        >
                        <a
                            class="text-[15px] font-semibold text-text-main hover:text-primary transition-colors whitespace-nowrap"
                            href="#contact">Contact Us</a
                        >
                    </nav>

                    <!-- CTA -->
                    <div class="flex items-center">
                        <a
                            href={`tel:${contactPhone?.replace(/[^0-9]/g, "")}`}
                            class="flex items-center justify-center h-12 px-6 rounded-full bg-primary text-white text-sm font-bold shadow-lg shadow-primary/20 hover:bg-secondary hover:shadow-xl hover:-translate-y-0.5 transition-all duration-300"
                        >
                            <span
                                class="material-symbols-outlined text-[20px] mr-2"
                                >call</span
                            >
                            <span class="whitespace-nowrap">Call Now</span>
                        </a>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="pt-20 md:pt-24">
            <slot />
        </div>

        <!-- Footer -->
        <footer class="bg-primary text-white pt-24 pb-12">
            <div class="max-w-[1280px] mx-auto px-6 lg:px-12">
                <!-- CTA Section -->
                <div
                    class="flex flex-col lg:flex-row items-start justify-between gap-12 mb-20"
                >
                    <div class="max-w-xl">
                        <a class="flex items-center gap-4 group mb-8" href="/">
                            {
                                footerLogo ? (
                                    <img
                                        src={urlFor(footerLogo)
                                            .width(200)
                                            .url()}
                                        alt={`${siteName} Logo`}
                                        class="w-20 h-20 object-contain"
                                    />
                                ) : (
                                    <img
                                        src="/logo.png"
                                        alt={`${siteName} Logo`}
                                        class="w-20 h-20 object-contain brightness-0 invert"
                                    />
                                )
                            }
                            <div class="flex flex-col">
                                <h1
                                    class="text-3xl font-black tracking-tight text-white leading-none"
                                >
                                    {siteName}
                                </h1>
                                <p
                                    class="text-[12px] font-bold tracking-[0.2em] uppercase text-blue-200 mt-2"
                                >
                                    Emergency Care
                                </p>
                            </div>
                        </a>
                        <p class="text-blue-100 text-xl leading-relaxed mb-8">
                            Board-certified emergency medical care available
                            24/7. We prioritize accuracy, speed, and patient
                            comfort in every visit.
                        </p>
                        <a
                            href={`tel:${contactPhone?.replace(/[^0-9]/g, "")}`}
                            class="bg-accent text-white px-10 py-5 rounded-full font-bold text-lg shadow-xl shadow-accent/30 hover:bg-accent-hover transition-colors w-full sm:w-auto inline-flex items-center justify-center"
                        >
                            <span class="material-symbols-outlined mr-2"
                                >call</span
                            >
                            Call {contactPhone}
                        </a>
                    </div>

                    <!-- Footer Links -->
                    <div
                        class="grid grid-cols-2 md:grid-cols-3 gap-12 lg:gap-24 w-full lg:w-auto"
                    >
                        <div>
                            <h4 class="font-bold text-lg mb-6 text-white">
                                Services
                            </h4>
                            <ul class="space-y-4 text-blue-200">
                                <li>
                                    <a
                                        class="hover:text-white transition-colors"
                                        href="#services">Emergency Care</a
                                    >
                                </li>
                                <li>
                                    <a
                                        class="hover:text-white transition-colors"
                                        href="#services">Pediatrics</a
                                    >
                                </li>
                                <li>
                                    <a
                                        class="hover:text-white transition-colors"
                                        href="#services">Trauma</a
                                    >
                                </li>
                                <li>
                                    <a
                                        class="hover:text-white transition-colors"
                                        href="#services">Diagnostics</a
                                    >
                                </li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-bold text-lg mb-6 text-white">
                                Patient Info
                            </h4>
                            <ul class="space-y-4 text-blue-200">
                                <li>
                                    <a
                                        class="hover:text-white transition-colors"
                                        href="#insurance">Billing & Insurance</a
                                    >
                                </li>
                                <li>
                                    <a
                                        class="hover:text-white transition-colors"
                                        href="#">Patient Portal</a
                                    >
                                </li>
                                <li>
                                    <a
                                        class="hover:text-white transition-colors"
                                        href="#">Privacy Policy</a
                                    >
                                </li>
                                <li>
                                    <a
                                        class="hover:text-white transition-colors"
                                        href="#">Accessibility</a
                                    >
                                </li>
                            </ul>
                        </div>
                        <div>
                            <h4
                                class="font-bold text-lg mb-6 text-white text-left"
                            >
                                Contact
                            </h4>
                            <ul
                                class="space-y-4 text-blue-200 text-left list-none p-0"
                            >
                                {
                                    addressParts.map((part: string) => (
                                        <li>{part.trim()}</li>
                                    ))
                                }
                                <li>{email}</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Copyright -->
                <div
                    class="border-t border-white/10 pt-8 flex flex-col md:flex-row justify-between items-center text-sm text-blue-200/60"
                >
                    <p>
                        &copy; {new Date().getFullYear()}
                        {siteName}. All rights reserved.
                    </p>
                    <div class="flex gap-6 mt-4 md:mt-0">
                        <a class="hover:text-white transition-colors" href="#"
                            >Privacy Policy</a
                        >
                        <a class="hover:text-white transition-colors" href="#"
                            >Terms of Service</a
                        >
                    </div>
                </div>
            </div>
        </footer>
    </body>
</html>
